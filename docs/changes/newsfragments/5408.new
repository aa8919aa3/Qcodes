Mark python 3.12 as supported and fix deprecation warnings with python 3.12
